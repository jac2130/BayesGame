
// circleCt is the container for the circles
function createSideBar(tutorial, circleCt)
{
    var sideBarContainer = new createjs.Container();
    var sideBar = makeRect(110, 800, "#331177");

    sideBar.render(sideBarContainer, {x:0, y:0});

    var nextYPosition = 150;
    var varBarButtonWidth = 98;
    var varBarButtonHeight = 80;
    var varSpacing = 20;
    var distBetweenYs = varBarButtonHeight + varSpacing;

    sideBar.addBayesVar = function(bayesVar)
    {
        var varBarContainer = new createjs.Container();
        var varBarButton = makeRect(varBarButtonWidth, varBarButtonHeight, 
                                    bayesVar.color);
        varBarButton.render(varBarContainer.shape, {x:0, y:0});
        var text = makeTextWidget(bayesVar.varText, 20, "Arial", "white");
        text.render(varBarContainer.shape, {x:20, y:20});

        varBarContainer.render(this.shape, {x:5, y:nextYPosition});
        nextYPosition += distBetweenYs;
    }

    var varBarContainer0 = new createjs.Container();
    var varBarContainer1 = new createjs.Container();
    var varBarContainer2 = new createjs.Container();

    var varBarButton0 = makeRect(98, 80, "blue");
    varBarButton0.render(varBarContainer0, {x:5, y:150});

    var varBarButton1 = makeRect(98, 80, "green");
    varBarButton1.render(varBarContainer1, {x:5, y:300});

    var varBarButton2 = makeRect(98, 80, "red");
    varBarButton2.render(varBarContainer2, {x:5, y:450});

    var textFont = "bold 20px Arial";
    var text0 = new createjs.Text("Contes\nDoor", textFont, "white");
    var text1 = new createjs.Text("Prize\nDoor", textFont, "white");
    var text2 = new createjs.Text("Monte\nDoor", textFont, "white");

    text0.x = 20;
    text0.y = 170;

    text1.x = 20;
    text1.y = 320;

    text2.x = 20;
    text2.y = 470;

    var variablesDragged = 0;

    varBarContainer0.addChild(text0);
    varBarContainer1.addChild(text1);
    varBarContainer2.addChild(text2);

    sideBarContainer.addChild(varBarContainer0);
    sideBarContainer.addChild(varBarContainer1);
    sideBarContainer.addChild(varBarContainer2);

    stage.addChild(sideBarContainer);

    var varBarExpanded0;
    var varBarOptionContainer0;

    varBarContainer0.on("rollover", function(event) {
        if (!circleMoving) {
            varBarOptionContainer0 = new createjs.Container();
            /*
            var varBarOption = new Rect([103,150], 75, 80, "#331177",
                                        varBarOptionContainer0);
                                        */
            var varBarOption = makeRect(75, 80, "#331177");
            varBarOption.render(varBarOptionContainer0, {x:103, y:150});
            var varCircle = makeBayesCircle(20, "blue");
            varCircle.render(varBarOptionContainer0, {x:140, y:190});

            this.addChild(varBarOptionContainer0);
            varBarExpanded0 = true;

            tutorial.trigger("sideBarIconHover", text0.text);

            varCircle.shape.on("mousedown", function(event) {
                this.parent.removeChild(this);
                stage.addChild(this);
                varCircle.justAdded = true;
                variablesDragged += 1;
                tutorial.trigger("circleDrag", text0.text, variablesDragged);
                //connectCircles(varCircle, circle1);
            }, null, true);

            varCircle.shape.on("click", function(event) {
                tutorial.trigger("circleClicked", text0.text);
            });

            varCircle.histogram = makeHist([20, 30, 10], ["A", "B", "C"], 
                                           700, 400, 20, tutorial);

            varCircle.shape.on("dblclick", function(event) {
                tutorial.trigger("circleDblClicked", text0.text);
                var blackFade = makeRect(stageWidth, stageHeight, "rgba(0, 0, 0, 0.8)");
                blackFade.render(stage, {x:0, y:0});
                this.widget.histogram.render(stage, {x:120, y:120});
                var doneButton = makeDoneButton(this.widget.histogram, 
                        stage, blackFade, tutorial);
                doneButton.render(stage, {x: 600, y: 550});
            });
        }
        //varBarOption = new Rect([73,50], 75, 80, "#8855CC", varBarContainer);
    });
    varBarContainer0.on("rollout", function(event) {
        if (varBarExpanded0) {
            this.removeChild(varBarOptionContainer0);
            varBarExpanded0 = false;
        }
    });

    var varBarExpanded1;
    var varBarOptionContainer1;
    varBarContainer1.on("rollover", function(event) {
        if (!circleMoving) {
            varBarOptionContainer1 = new createjs.Container();
            var varBarOption = makeRect(75, 80, "#331177");
            varBarOption.render(varBarOptionContainer1, {x:103, y:300});

            var varCircle = makeBayesCircle(20, "green");
            varCircle.render(varBarOptionContainer1, {x: 133, y: 335});
            this.addChild(varBarOptionContainer1);
            varBarExpanded1 = true;
            varCircle.shape.on("mousedown", function(event) {
                this.parent.removeChild(this);
                stage.addChild(this);
                varCircle.justAdded = true;
                //connectCircles(varCircle, circle1);
                variablesDragged += 1;
                tutorial.trigger("circleDrag", text1.text, variablesDragged);
            }, null, true);

            varCircle.shape.on("click", function(event) {
                tutorial.trigger("circleClicked", text1.text);
            });

            varCircle.histogram = makeHist([20, 30, 10], ["A", "B", "C"], 
                                           700, 400, 20, tutorial);

            varCircle.shape.on("dblclick", function(event) {
                tutorial.trigger("circleDblClicked", text1.text);
                var blackFade = makeRect(stageWidth, stageHeight, "rgba(0, 0, 0, 0.8)");
                blackFade.render(stage, {x:0, y:0});
                this.widget.histogram.render(stage, {x:120,y:120});
                var doneButton = makeDoneButton(this.widget.histogram, 
                        stage, blackFade, tutorial);
                doneButton.render(stage, {x: 600, y: 550});
            });
        }
        //varBarOption = new Rect([73,50], 75, 80, "#8855CC", varBarContainer);
    });
    varBarContainer1.on("rollout", function(event) {
        if (varBarExpanded1) {
            this.removeChild(varBarOptionContainer1);
            varBarExpanded1 = false;
        }
    });

    var varBarExpanded2;
    var varBarOptionContainer2;
    varBarContainer2.on("rollover", function(event) {
        if (!circleMoving) {
            varBarOptionContainer2 = new createjs.Container();
            var varBarOption = makeRect(75, 80, "#331177");
            varBarOption.render(varBarOptionContainer2, {x:103, y:450});

            var varCircle = makeBayesCircle(20, "red");
            varCircle.render(varBarOptionContainer2, {x: 133, y: 485});

            this.addChild(varBarOptionContainer2);
            varBarExpanded2 = true;
            varCircle.shape.on("mousedown", function(event) {
                this.parent.removeChild(this);
                stage.addChild(this);
                varCircle.justAdded = true;
                //connectCircles(varCircle, circle1);
                variablesDragged += 1;
                tutorial.trigger("circleDrag", text2.text, variablesDragged);
            }, null, true);

            varCircle.switcher = makeSwitcher(clickOutList, tutorial);

            varCircle.shape.on("click", function(event) {
                tutorial.trigger("circleClicked", text2.text);
            });

            varCircle.shape.on("dblclick", function(event) {
                tutorial.trigger("circleDblClicked", text2.text);
                var blackFade = makeRect(stageWidth, stageHeight, "rgba(0, 0, 0, 0.8)");
                blackFade.render(stage, {x:0, y:0});
                this.widget.switcher.render(stage, {x:100,y:100});
                var doneButton = makeDoneButton(this.widget.switcher, 
                        stage, blackFade, tutorial);
                doneButton.render(stage, {x: 700, y: 630});
            });

        }
        //varBarOption = new Rect([73,50], 75, 80, "#8855CC", varBarContainer);
    });

    varBarContainer2.on("rollout", function(event) {
        if (varBarExpanded2) {
            this.removeChild(varBarOptionContainer2);
            varBarExpanded2 = false;
        }
    });
    return sideBar;
}
